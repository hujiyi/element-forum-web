{"version":3,"sources":["webpack:///./src/api/service/topic_service.js","webpack:///./src/views/home/components/LatestTopic.vue?da63","webpack:///src/views/home/components/LatestTopic.vue","webpack:///./src/views/home/components/LatestTopic.vue?c71b","webpack:///./src/views/home/components/LatestTopic.vue","webpack:///./src/views/home/components/LatestTopic.vue?ac02","webpack:///./src/model/topic.js"],"names":["TABLE_NAME","TopicService","table_name","BaseService","prototype","getTopicByCategory","id","limit","skip","sort_field","query","LC","Query","this","board","Object","createWithoutData","include","equalTo","descending","isMinus","console","log","substr","addDescending","addAscending","select","count","total","find","response","code","render","_vm","_h","$createElement","_c","_self","staticClass","style","color","attrs","staticStyle","name","params","item","_v","_s","title","description","topics","length","_e","_l","index","key","_f","createdAt","staticRenderFns","component","Topic","content","views","reply","level","getCategory","label","get","value","getUser","user","username","email","formJson","category","updatedAt","createdBy","lastEditor"],"mappings":"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","file":"js/chunk-f9970f68.a984500b.js","sourcesContent":["import LC from 'leancloud-storage';  // 导入 leancloud 数据存储模块\r\nimport BaseService from './base_service';  // 导入访问 leancloud 数据存储的基类\r\n\r\n\r\nconst TABLE_NAME = 'Topic';  // leancloud 中存储数据的表名(Class)\r\n\r\n/**\r\n * 对leancloud应用中 名为 \"Topic\" 的 Class 进行数据操作的类\r\n */\r\nclass TopicService extends BaseService {\r\n    constructor(table_name) {\r\n        // 调用父类的构造函数\r\n        super(table_name);\r\n        // 当前子类的属性 this.TABLE_NAME\r\n        this.TABLE_NAME = table_name;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 查询指定 id 的版块 的前 n 条记录\r\n * @param {*} id 版块的id\r\n * @param {*} limit 返回的记录数\r\n * @returns \r\n */\r\nTopicService.prototype.getTopicByCategory = async function (id, limit = 5, skip = 0, sort_field = '-createdAt') {\r\n    // console.log(`category id:`, id);\r\n    try {\r\n        let query = new LC.Query(this.TABLE_NAME);\r\n        const board = LC.Object.createWithoutData('Category', id);  // 根据 id 获取版块的原始数据\r\n        query.include(['createdBy', 'lastEditor']);  // 包含查询, 获取 创建者和修改者的详细信息\r\n        query.equalTo('category', board)    // 关系查询\r\n            .descending('level');           // 第一排序属性：降序\r\n\r\n        // 第二排序属性： this.isMinus()  是父类中定义的方法，判断排序的字段是否 负号 开头\r\n        if (this.isMinus(sort_field)) {\r\n            console.log(sort_field, sort_field.substr(1));\r\n            // 去掉负号后的字段名降序\r\n            query.addDescending(sort_field.substr(1));\r\n        }\r\n        else {\r\n            query.addAscending(sort_field);  // 升序\r\n        }\r\n\r\n        // 指定需要返回的属性，并包括内置属性 objectId、createdAt 和 updatedAt\r\n        query.select(['title', 'level', 'reply', 'views', 'level', 'createdBy', 'lastEditor']);\r\n        let total = await query.count();   // 返回记录总数\r\n        console.log('total:', total);\r\n        // 分页查询参数\r\n        let response = await query.limit(limit).skip(skip).find();\r\n        console.log('getTopicByCategory:', total, response);\r\n        return {\r\n            \"status_code\": \"ok\",\r\n            \"totalCount\": total,\r\n            \"reslut\": response,\r\n        }\r\n    } catch (e) {\r\n        console.log('查询数据错误：', e.code, e);\r\n        return {\r\n            \"status_code\": e.code,\r\n            \"totalCount\": 0,\r\n            \"reslut\": e,\r\n        };\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n// 导出子类时使用 new 直接进行实例化\r\nexport default new TopicService(TABLE_NAME);","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"board-border p-4\",style:((\"border-left-color: \" + _vm.color + \";\"))},[_c('el-row',[_c('el-col',{attrs:{\"md\":10,\"sm\":24}},[_c('p',{staticClass:\"board-title\"},[_c('router-link',{staticStyle:{\"text-decoration\":\"none\"},attrs:{\"to\":{ name: 'Board', params: { id: _vm.item.id } }}},[_vm._v(_vm._s(_vm.item.title))])],1),_c('p',{staticClass:\"board-description\"},[_vm._v(_vm._s(_vm.item.description))])]),_c('el-col',{staticClass:\"hidden-sm-and-down\",attrs:{\"md\":14}},[(_vm.topics.length === 0)?_c('span',[_vm._v(\"当前版块无内容，请添加话题。\")]):_vm._e(),_vm._l((_vm.topics),function(item,index){return _c('div',{key:index},[_c('div',{staticClass:\"horiz-container my-2\"},[_c('router-link',{attrs:{\"to\":{ name: 'Topic', params: { id: item.id } }}},[_c('el-link',{attrs:{\"underline\":false,\"type\":\"primary\"}},[_vm._v(_vm._s(item.title))])],1),_c('span',{staticClass:\"spacer\"}),_c('span',{staticClass:\"created-time\"},[_vm._v(_vm._s(_vm._f(\"datetimeFromNow\")(item.createdAt)))])],1)])})],2)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"board-border p-4\" :style=\"`border-left-color: ${color};`\">\r\n        <el-row>\r\n            <el-col :md=\"10\" :sm=\"24\">\r\n                <p class=\"board-title\">\r\n                    <router-link\r\n                        :to=\"{ name: 'Board', params: { id: item.id } }\"\r\n                        style=\" text-decoration: none;\"\r\n                    >{{ item.title }}</router-link>\r\n                </p>\r\n                <p class=\"board-description\">{{ item.description }}</p>\r\n            </el-col>\r\n            <el-col :md=\"14\" class=\"hidden-sm-and-down\">\r\n                <span v-if=\"topics.length === 0\">当前版块无内容，请添加话题。</span>\r\n                <div v-for=\"(item, index) in topics\" :key=\"index\">\r\n                    <div class=\"horiz-container my-2\">\r\n                        <router-link :to=\"{ name: 'Topic', params: { id: item.id } }\">\r\n                            <el-link :underline=\"false\" type=\"primary\">{{ item.title }}</el-link>\r\n                        </router-link>\r\n\r\n                        <span class=\"spacer\"></span>\r\n                        <span class=\"created-time\">{{ item.createdAt | datetimeFromNow }}</span>\r\n                    </div>\r\n                </div>\r\n            </el-col>\r\n        </el-row>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport TopicService from '../../../api/service/topic_service';\r\nimport Topic from '../../../model/topic';\r\nexport default {\r\n    name: 'LatestTopic',\r\n    props: ['item', 'color'],   // item: 外部传入的 版块 值, color: 外部传入的 左则粗边框颜色\r\n    data: () => ({\r\n        topics: [],\r\n        pageSize: 8,\r\n    }),\r\n    mounted() {\r\n        this.getTopics();\r\n    },\r\n    methods: {\r\n        async getTopics() {\r\n            this.topics = [];\r\n            let response = await TopicService.getTopicByCategory(this.item.id);\r\n            if (response.status_code === \"ok\") {\r\n                this.topics = response.reslut.map(item => { return new Topic().formJson(item) });\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n\r\n}\r\n</script>\r\n\r\n<style>\r\n.board-border {\r\n    border-left-style: solid;\r\n    border-left-width: 12px;\r\n    border-bottom-style: solid;\r\n    border-bottom-width: 1px;\r\n    border-bottom-color: #c0c4cc;\r\n    border-top-style: solid;\r\n    border-top-width: 1px;\r\n    border-top-color: #c0c4cc;\r\n    /* margin-bottom: -1px; 用于解决div边框重叠 */\r\n    margin-bottom: -1px;\r\n}\r\n\r\n.board-title {\r\n    font-size: 18px;\r\n    font-weight: bold;\r\n}\r\n\r\n.board-description {\r\n    font-size: 14px;\r\n    color: #919191;\r\n}\r\n\r\n.created-time {\r\n    color: #919191;\r\n    font-size: 14px;\r\n}\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LatestTopic.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LatestTopic.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./LatestTopic.vue?vue&type=template&id=3ce5b0b9&\"\nimport script from \"./LatestTopic.vue?vue&type=script&lang=js&\"\nexport * from \"./LatestTopic.vue?vue&type=script&lang=js&\"\nimport style0 from \"./LatestTopic.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LatestTopic.vue?vue&type=style&index=0&lang=css&\"","class Topic {\r\n    constructor(title = '', content = '') {\r\n        this.title = title;\r\n        this.content = content;\r\n        this.views = 0;\r\n        this.reply = 0;\r\n        this.level = 0;\r\n    }\r\n}\r\n\r\nTopic.prototype.formJson = function (item) {\r\n    return {\r\n        id: item.id,\r\n        category: item.get('category')\r\n            ? getCategory(item.get('category'))\r\n            : '',\r\n        title: item.get('title'),\r\n        content: item.get('content'),\r\n        views: item.get('views'),\r\n        reply: item.get('reply'),\r\n        level: item.get('level'),\r\n        createdAt: item.createdAt,\r\n        updatedAt: item.updatedAt,\r\n        createdBy: item.get(\"createdBy\")\r\n            ? getUser(item.get(\"createdBy\"))\r\n            : \"\",\r\n        lastEditor: item.get(\"lastEditor\")\r\n            ? getUser(item.get(\"lastEditor\"))\r\n            : \"\",\r\n    }\r\n}\r\n\r\n// 版块, 此处数据适用于下拉框\r\nfunction getCategory(item) {\r\n    return {\r\n        label: item.get('title'),\r\n        value: item.id,\r\n    }\r\n}\r\n\r\n// 获取用户表中各个字段的值\r\nfunction getUser(user) {\r\n    // console.log(user);\r\n    return {\r\n        id: user.id,\r\n        username: user.get(\"username\"),\r\n        email: user.get(\"email\"),\r\n    };\r\n}\r\nexport default Topic;"],"sourceRoot":""}