{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///./src/views/account/pages/Login.vue?583b","webpack:///./src/views/account/pages/Login.vue?09a1","webpack:///src/views/account/pages/Login.vue","webpack:///./src/views/account/pages/Login.vue?c9e3","webpack:///./src/views/account/pages/Login.vue","webpack:///./src/api/service/account_service.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_v","model","value","callback","$$v","username","expression","password","on","login","staticRenderFns","localStorage","setItem","token","console","log","response","user","curr","component","AccountService","email","LC","User","setUsername","setPassword","set","setEmail","signUp","code","logIn","logOut","requestPasswordReset","current","getSessionToken"],"mappings":"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","file":"js/chunk-77e5fa0c.6b114ea7.js","sourcesContent":["export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-card',{staticClass:\"login-module\",attrs:{\"shadow\":\"always\"}},[_c('el-form',[_c('div',{staticClass:\"horiz-container form-title\"},[_c('span',[_vm._v(\"用户登录\")]),_c('div',{staticClass:\"spacer\"}),_c('span',[_c('router-link',{attrs:{\"to\":\"/\"}},[_c('i',{staticClass:\"fa fa-home fa-2x\",attrs:{\"aria-hidden\":\"true\"}})])],1)]),_c('el-form-item',[_c('el-input',{attrs:{\"type\":\"text\",\"prefix-icon\":\"fa fa-user-o\",\"placeholder\":\"用户名\"},model:{value:(_vm.username),callback:function ($$v) {_vm.username=$$v},expression:\"username\"}})],1),_c('el-form-item',[_c('el-input',{attrs:{\"type\":\"password\",\"prefix-icon\":\"fa fa-lock\",\"placeholder\":\"密码\"},model:{value:(_vm.password),callback:function ($$v) {_vm.password=$$v},expression:\"password\"}})],1),_c('el-form-item',[_c('el-button',{staticClass:\"full-width\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.login}},[_vm._v(\"登录\")])],1),_c('div',{staticClass:\"horiz-container\"},[_c('div',{staticClass:\"spacer\"}),_c('router-link',{staticClass:\"mx-2\",attrs:{\"to\":\"/password_reset\"}},[_c('el-link',{attrs:{\"underline\":false,\"type\":\"warning\"}},[_vm._v(\"忘记密码\")])],1),_c('router-link',{staticClass:\"mx-2\",attrs:{\"to\":\"/signup\"}},[_c('el-link',{attrs:{\"underline\":false,\"type\":\"danger\"}},[_vm._v(\"没有账号\")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <el-card shadow=\"always\" class=\"login-module\">\r\n        <el-form>\r\n            <div class=\"horiz-container form-title\">\r\n                <span>用户登录</span>\r\n                <div class=\"spacer\"></div>\r\n                <span>\r\n                    <router-link to=\"/\">\r\n                        <i class=\"fa fa-home fa-2x\" aria-hidden=\"true\"></i>\r\n                    </router-link>\r\n                </span>\r\n            </div>\r\n            <el-form-item>\r\n                <el-input\r\n                    type=\"text\"\r\n                    prefix-icon=\"fa fa-user-o\"\r\n                    v-model=\"username\"\r\n                    placeholder=\"用户名\"\r\n                ></el-input>\r\n            </el-form-item>\r\n            <el-form-item>\r\n                <el-input\r\n                    type=\"password\"\r\n                    prefix-icon=\"fa fa-lock\"\r\n                    v-model=\"password\"\r\n                    placeholder=\"密码\"\r\n                ></el-input>\r\n            </el-form-item>\r\n            <el-form-item>\r\n                <el-button class=\"full-width\" type=\"primary\" @click=\"login\">登录</el-button>\r\n            </el-form-item>\r\n            <div class=\"horiz-container\">\r\n                <div class=\"spacer\"></div>\r\n                <router-link to=\"/password_reset\" class=\"mx-2\">\r\n                    <el-link :underline=\"false\" type=\"warning\">忘记密码</el-link>\r\n                </router-link>\r\n                <router-link to=\"/signup\" class=\"mx-2\">\r\n                    <el-link :underline=\"false\" type=\"danger\">没有账号</el-link>\r\n                </router-link>\r\n            </div>\r\n        </el-form>\r\n    </el-card>\r\n</template>\r\n\r\n<script>\r\nimport AccountService from \"@/api/service/account_service\";\r\nexport default {\r\n    name: \"Login\",\r\n    data: () => ({\r\n        username: \"zhangsan\",   // 用于输入用户名， 此处未实现使用邮箱登录\r\n        password: \"123456\",     // 用于输入密码\r\n    }),\r\n    methods: {\r\n        async login() {\r\n\r\n            // 登录函数返回 包含 状态码 和 用户 两个信息的对象， 状态码为 字符类型 的 数字字符\r\n            let response = await AccountService.logIn(this.username, this.password);\r\n            // 为了进行登录失败的提示，只能通过 typeof currentUser 来 判断登录是否成功\r\n            if (response.status_code == \"200\") {\r\n                // 读取进入登录页的前一页地址\r\n                const curr = localStorage.getItem(\"preRoute\");\r\n                let token = await AccountService.getToken();\r\n                localStorage.setItem(\"token\", token);   // 保存当前用户的 session token\r\n                // 在状态中保存当前用户信息\r\n                console.log('response.user:', response.user);\r\n                // 登录成功后的用户数据 保存到 vuex 状态中， 以便在其他组件共享使用\r\n                this.$store.commit('SET_CURRENT_USER', this.getUser(response.user));\r\n\r\n                if (curr === null || curr === '/' || curr === '/account' || curr === \"/login\") {\r\n                    this.$router.push({ path: \"/dashboard\" });\r\n                } else {\r\n                    // 跳转到进入登录页之前的页面\r\n                    this.$router.push({ path: curr });\r\n                }\r\n\r\n            } else {\r\n                let errorMsg = '';\r\n                switch (response.status_code) {\r\n                    case \"210\":\r\n                        errorMsg = '用户名和密码不匹配';\r\n                        break;\r\n                    case \"211\":\r\n                        errorMsg = '找不到用户';\r\n                        break;\r\n                    case \"219\":\r\n                        errorMsg = '登录失败次数超过限制，请稍候再试，或者通过忘记密码重设密码';\r\n                        break;\r\n                    default:\r\n                        errorMsg = '请求被终止，请检查网络连接状况';\r\n                }\r\n                // 使用 Notification 通知 显示登录失败的的提示信息\r\n                this.$notify.error({\r\n                    title: '登录失败',      // 标题\r\n                    message: errorMsg,     // 消息内容\r\n                    // offset: 100,        // 偏移量，消息距屏幕边缘偏移一段距离\r\n                    showClose: false,      // 不显示关闭按钮，只能等自动关闭\r\n                });\r\n\r\n            }\r\n        },\r\n\r\n        getUser(user) {\r\n            // console.log(user);\r\n            return {\r\n                id: user.id,\r\n                username: user.get(\"username\"),\r\n                email: user.get(\"email\"),\r\n            };\r\n        },\r\n\r\n    },\r\n};\r\n</script>\r\n\r\n<style>\r\n.login-module {\r\n    width: 380px;\r\n}\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=40ea9a55&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import LC from 'leancloud-storage';  // 导入 leancloud 数据存储模块\r\n\r\n/**\r\n * 账号管理的类\r\n */\r\nclass AccountService {\r\n\r\n    /**\r\n     * 注册新用户账号\r\n     * @param {*} username \r\n     * @param {*} password \r\n     * @param {*} email \r\n     * @returns 注册返回的状态码： 202: \"用户名已被注册\", 203: \"邮箱已被注册\", \"-1\": \"无法连接到服务器\"\r\n     * \r\n     */\r\n    async signUp(username, password, email = '') {\r\n        try {\r\n            let user = new LC.User();\r\n            user.setUsername(username);\r\n            user.setPassword(password);\r\n            // 添加一个 昵称 字段，默认为用户名\r\n            user.set('nickname', username);\r\n            if (email) {\r\n                user.setEmail(email);\r\n            }\r\n            let response = await user.signUp();\r\n            console.log('注册账号成功：', response);\r\n            return {\r\n                \"status_code\": \"200\",   // 注册状态码\r\n                \"user\": response,    // 用户\r\n            };\r\n        } catch (e) {\r\n            console.log('注册账号失败：', e.code, e);\r\n            return {\r\n                // 注册返回的状态码： 202: \"用户名已被注册\", 203: \"邮箱已被注册\", \"-1\": \"无法连接到服务器\"\r\n                \"status_code\": e.code,   // 注册状态码\r\n                \"user\": null,    // 注册失败，返回用户为 null\r\n            };\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 用户登录 \r\n     * @param {*} username \r\n     * @param {*} password \r\n     * @returns  登录状态代码 和用户\r\n     *  200: 登录成功\r\n     *  210: 密码错误； \r\n     *  211：用户不存在, \r\n     *  219: 重试次数太多\r\n     *  -1 : 请求被终止，一般是网络有问题\r\n     */\r\n    async logIn(username, password) {\r\n        try {\r\n            let user = await LC.User.logIn(username, password);\r\n            if (user) {\r\n                console.log('登录成功:', user);\r\n                return {\r\n                    \"status_code\": \"200\",   // 登录状态码\r\n                    \"user\": user,    // 用户\r\n                };\r\n            }\r\n        } catch (e) {\r\n            // e.code\r\n            // 210: 密码错误； \r\n            //  211：用户不存在, \r\n            //  -1 Error: Request has been terminated\r\n            console.log('登录失败：', e.code, e);\r\n            return {\r\n                \"status_code\": e.code,\r\n                \"user\": null,\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * 退出登录 \r\n     * @returns 无返回值\r\n     */\r\n    async logOut() {\r\n        return LC.User.logOut();\r\n    }\r\n\r\n    /**\r\n     * 通过电子邮件重置密码\r\n     * @param {*} email \r\n     * @returns 状态码：\r\n     * \"200\": 发送邮件成功；\r\n     * \"1\": \"请不要往同一个邮件地址发送太多邮件\",\r\n     * \"205\": \"此电子邮箱没有被注册使用\",\r\n     * \"-1\": \"请求被终止，请检查网络连接状况\"\r\n     */\r\n    async passwordResetByEmail(email) {\r\n        try {\r\n            let response = await LC.User.requestPasswordReset(email);\r\n            console.log(response.code, typeof response);\r\n            return \"200\";            \r\n        } catch (e) {\r\n            console.log(\"发送邮件：\", e.code, e);\r\n            return e.code      // 发送邮件不成功，返回错误代码\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 获取当前用户的 session token\r\n     * @returns session token\r\n     */\r\n    async getToken(){\r\n        return LC.User.current().getSessionToken();\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default new AccountService();"],"sourceRoot":""}